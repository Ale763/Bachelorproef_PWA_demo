{"remainingRequest":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/babel-loader/lib/index.js!/Users/ale/Documents/Bachproef/pwa-3/node_modules/ts-loader/index.js??ref--13-2!/Users/ale/Documents/Bachproef/pwa-3/node_modules/vuetify-loader/lib/loader.js!/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/ale/Documents/Bachproef/pwa-3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ale/Documents/Bachproef/pwa-3/src/components/Product.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/ale/Documents/Bachproef/pwa-3/src/components/Product.vue","mtime":1556181469163},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/ts-loader/index.js","mtime":1545640398000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/vuetify-loader/lib/loader.js","mtime":1549812933000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.to-string\";\nimport _classCallCheck from \"/Users/ale/Documents/Bachproef/pwa-3/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/ale/Documents/Bachproef/pwa-3/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/ale/Documents/Bachproef/pwa-3/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/ale/Documents/Bachproef/pwa-3/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/ale/Documents/Bachproef/pwa-3/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { MagentoAPIService } from \"../services/MagentoAPIService\";\nimport { Component, Vue } from \"vue-property-decorator\";\nvar magentoApiService = new MagentoAPIService();\n\nvar Product =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(Product, _Vue);\n\n  function Product() {\n    var _this;\n\n    _classCallCheck(this, Product);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Product).apply(this, arguments));\n    _this.cached = false;\n    return _this;\n  }\n\n  _createClass(Product, [{\n    key: \"getproduct\",\n    value: function getproduct() {\n      var product = this.$store.getters['products/product'](this.sku);\n      if (product == null && this.sku != null) this.fetchProduct(this.sku);\n      return product;\n    }\n  }, {\n    key: \"searchCache\",\n    value: function searchCache(sku) {\n      return window.caches.open('products-cache').then(function (cache) {\n        console.log(\"Searching keys for id\", sku); // console.log(\"KEYS\", keys);\n\n        return cache.keys().then(function (urls) {\n          for (var i = 0; i < urls.length; ++i) {\n            if (urls[i].url === \"\".concat(MagentoAPIService.PRODUCTS_API, \"/\").concat(sku)) return true;\n          }\n\n          return false;\n        });\n      }).catch(function (error) {\n        console.error(\"Error cached\", error);\n      });\n    }\n  }, {\n    key: \"fetchProduct\",\n    value: function fetchProduct(sku) {\n      this.send_message_to_sw(this.sku);\n      this.$store.dispatch('products/fetchProduct', sku).then(function (data) {\n        console.log('Fetch ok', data);\n      }).catch(function (error) {\n        console.error('Fetch error', error);\n      });\n    }\n  }, {\n    key: \"send_message_to_sw\",\n    value: function send_message_to_sw(sku) {\n      if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.ready.then(function (serviceWorkerRegistration) {\n          // Let's see if you have a subscription already\n          return serviceWorkerRegistration.pushManager.getSubscription();\n        }).then(function (subscription) {\n          if (!subscription) {} // You do not have subscription\n          // You have subscription.\n          // Send data to service worker\n\n\n          console.log(\"Sending to SW...\");\n          navigator.serviceWorker.controller.postMessage({\n            \"data\": {\n              \"dev_comm\": true,\n              \"id\": sku\n            }\n          });\n        });\n      }\n    }\n  }, {\n    key: \"deleteProductFromCache\",\n    value: function deleteProductFromCache() {\n      this.send_message_to_sw(this.id);\n    }\n  }, {\n    key: \"toggleCache\",\n    value: function toggleCache() {\n      // event.preventDefault();\n      console.log(\"Firing for product: \", this.sku);\n\n      if (this.cached) {\n        this.deleteProductFromCache(); // this.cached = false;\n      } else {\n        this.fetchProduct(this.id); // this.cached = true;\n      }\n\n      console.log(\"Product \".concat(this.id, \": Cache = \").concat(this.cached)); // this.cached = !this.cached;\n    }\n  }, {\n    key: \"created\",\n    value: function created() {\n      var _this2 = this;\n\n      return this.searchCache(this.sku).then(function (result) {\n        console.log(\"Search from cache: \", result);\n        if (result != null) _this2.cached = result;\n      }); // this.$store.dispatch('posts/fetchPost', this.id);\n    }\n  }]);\n\n  return Product;\n}(Vue);\n\nProduct = tslib_1.__decorate([Component({\n  props: {\n    sku: String\n  }\n})], Product);\nexport default Product;",{"version":3,"sources":["/Users/ale/Documents/Bachproef/pwa-3/node_modules/vuetify-loader/lib/loader.js!/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/ale/Documents/Bachproef/pwa-3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ale/Documents/Bachproef/pwa-3/src/components/Product.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\timport {MagentoAPIService} from \"../services/MagentoAPIService\";\n\timport {Product}           from \"../objects/Product\";\n\timport { Component, Vue }  from \"vue-property-decorator\";\n\n\tconst magentoApiService = new MagentoAPIService();\n\n\t@Component({\n\t\t           props:\n\t\t           {\n\t\t\t           sku: String\n\t\t           }\n\t           })\n\texport default class Product extends Vue\n\t{\n        cached: Boolean = false;\n\n\n\n\t\t\tgetproduct()\n\t\t{\n\t\t\tlet product = this.$store.getters['products/product'](this.sku);\n\t\t\tif (product == null && this.sku != null)\n\t\t\tthis.fetchProduct(this.sku);\n\t\t\treturn product;\n\t\t}\n\n\n\t\tsearchCache(sku)\n\t\t{\n\t\t\treturn window.caches.open('products-cache')\n\t\t\t             .then(cache =>\n\t\t\t                   {\n\t\t\t\t                   console.log(\"Searching keys for id\", sku);\n\t\t\t\t                   // console.log(\"KEYS\", keys);\n\t\t\t\t                   return cache.keys()\n\t\t\t\t                               .then(urls =>\n\t\t\t\t                                     {\n\t\t\t\t\t                                     for (let i = 0; i < urls.length; ++ i)\n\t\t\t\t\t                                     {\n\t\t\t\t\t\t                                     if (urls[i].url ===\n\t\t\t\t\t\t                                     `${MagentoAPIService.PRODUCTS_API}/${sku}`)\n\t\t\t\t\t\t\t                                     return true;\n\t\t\t\t\t                                     }\n\t\t\t\t\t                                     return false;\n\t\t\t\t                                     });\n\t\t\t                   }\n\t\t\t             )\n\t\t\t             .catch(error => {console.error(\"Error cached\", error)})\n\t\t}\n\t\tfetchProduct(sku)\n\t\t{\n\t\t\tthis.send_message_to_sw(this.sku);\n\t\t\tthis.$store.dispatch('products/fetchProduct', sku)\n\t\t\t    .then((data) =>\n\t\t\t          {\n\t\t\t\t          console.log('Fetch ok', data);\n\t\t\t          })\n\t\t\t    .catch((error) =>\n\t\t\t           {\n\t\t\t\t           console.error('Fetch error', error);\n\t\t\t           });\n\t\t}\n\t\tsend_message_to_sw(sku)\n\t\t{\n\t\t\tif ('serviceWorker' in navigator)\n\t\t\t{\n\t\t\t\tnavigator.serviceWorker.ready\n\t\t\t\t         .then(function (serviceWorkerRegistration)\n\t\t\t\t               {\n\t\t\t\t\t               // Let's see if you have a subscription already\n\t\t\t\t\t               return serviceWorkerRegistration.pushManager.getSubscription();\n\t\t\t\t               })\n\t\t\t\t         .then(function (subscription)\n\t\t\t\t               {\n\t\t\t\t\t               if (!subscription)\n\t\t\t\t\t               {\n\t\t\t\t\t\t               // You do not have subscription\n\t\t\t\t\t               }\n\t\t\t\t\t               // You have subscription.\n\t\t\t\t\t               // Send data to service worker\n\t\t\t\t\t               console.log(\"Sending to SW...\");\n\t\t\t\t\t               navigator.serviceWorker.controller.postMessage(\n\t\t\t\t\t               {\n\t\t\t\t\t\t               \"data\":\n\t\t\t\t\t\t               {\n\t\t\t\t\t\t\t               \"dev_comm\": true,\n\t\t\t\t\t\t\t               \"id\": sku\n\t\t\t\t\t\t               }\n\t\t\t\t\t               });\n\n\t\t\t\t               })\n\t\t\t}\n\t\t}\n        deleteProductFromCache()\n\t\t{\n\t\t\tthis.send_message_to_sw(this.id);\n\t\t}\n\t\ttoggleCache()\n\t\t{\n\t\t\t// event.preventDefault();\n\t\t\tconsole.log(\"Firing for product: \", this.sku);\n\t\t\tif (this.cached)\n\t\t\t{\n\t\t\t\tthis.deleteProductFromCache()\n\t\t\t\t// this.cached = false;\n\t\t\t} else\n\t\t\t{\n\t\t\t\tthis.fetchProduct(this.id)\n\t\t\t\t// this.cached = true;\n\t\t\t}\n\t\t\tconsole.log(`Product ${this.id}: Cache = ${this.cached}`);\n\t\t\t// this.cached = !this.cached;\n\t\t}\n\n\n\tcreated()\n\t{\n\t\treturn this.searchCache(this.sku)\n\t\t           .then(result =>\n\t\t                 {\n\t\t\t                 console.log(\"Search from cache: \", result);\n\t\t\t                 if (result != null)\n\t\t\t\t                 this.cached = result;\n\t\t                 })\n\t\t// this.$store.dispatch('posts/fetchPost', this.id);\n\t}\n\t}\n"],"sourceRoot":""}]}