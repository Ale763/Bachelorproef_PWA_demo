{"remainingRequest":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ale/Documents/Bachproef/pwa-3/src/components/Product.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/ale/Documents/Bachproef/pwa-3/src/components/Product.vue","mtime":1556181469163},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/ts-loader/index.js","mtime":1545640398000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/vuetify-loader/lib/loader.js","mtime":1549812933000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\timport {MagentoAPIService} from \"../services/MagentoAPIService\";\n\timport {Product}           from \"../objects/Product\";\n\timport { Component, Vue }  from \"vue-property-decorator\";\n\n\tconst magentoApiService = new MagentoAPIService();\n\n\t@Component({\n\t\t           props:\n\t\t           {\n\t\t\t           sku: String\n\t\t           }\n\t           })\n\texport default class Product extends Vue\n\t{\n        cached: Boolean = false;\n\n\n\n\t\t\tgetproduct()\n\t\t{\n\t\t\tlet product = this.$store.getters['products/product'](this.sku);\n\t\t\tif (product == null && this.sku != null)\n\t\t\tthis.fetchProduct(this.sku);\n\t\t\treturn product;\n\t\t}\n\n\n\t\tsearchCache(sku)\n\t\t{\n\t\t\treturn window.caches.open('products-cache')\n\t\t\t             .then(cache =>\n\t\t\t                   {\n\t\t\t\t                   console.log(\"Searching keys for id\", sku);\n\t\t\t\t                   // console.log(\"KEYS\", keys);\n\t\t\t\t                   return cache.keys()\n\t\t\t\t                               .then(urls =>\n\t\t\t\t                                     {\n\t\t\t\t\t                                     for (let i = 0; i < urls.length; ++ i)\n\t\t\t\t\t                                     {\n\t\t\t\t\t\t                                     if (urls[i].url ===\n\t\t\t\t\t\t                                     `${MagentoAPIService.PRODUCTS_API}/${sku}`)\n\t\t\t\t\t\t\t                                     return true;\n\t\t\t\t\t                                     }\n\t\t\t\t\t                                     return false;\n\t\t\t\t                                     });\n\t\t\t                   }\n\t\t\t             )\n\t\t\t             .catch(error => {console.error(\"Error cached\", error)})\n\t\t}\n\t\tfetchProduct(sku)\n\t\t{\n\t\t\tthis.send_message_to_sw(this.sku);\n\t\t\tthis.$store.dispatch('products/fetchProduct', sku)\n\t\t\t    .then((data) =>\n\t\t\t          {\n\t\t\t\t          console.log('Fetch ok', data);\n\t\t\t          })\n\t\t\t    .catch((error) =>\n\t\t\t           {\n\t\t\t\t           console.error('Fetch error', error);\n\t\t\t           });\n\t\t}\n\t\tsend_message_to_sw(sku)\n\t\t{\n\t\t\tif ('serviceWorker' in navigator)\n\t\t\t{\n\t\t\t\tnavigator.serviceWorker.ready\n\t\t\t\t         .then(function (serviceWorkerRegistration)\n\t\t\t\t               {\n\t\t\t\t\t               // Let's see if you have a subscription already\n\t\t\t\t\t               return serviceWorkerRegistration.pushManager.getSubscription();\n\t\t\t\t               })\n\t\t\t\t         .then(function (subscription)\n\t\t\t\t               {\n\t\t\t\t\t               if (!subscription)\n\t\t\t\t\t               {\n\t\t\t\t\t\t               // You do not have subscription\n\t\t\t\t\t               }\n\t\t\t\t\t               // You have subscription.\n\t\t\t\t\t               // Send data to service worker\n\t\t\t\t\t               console.log(\"Sending to SW...\");\n\t\t\t\t\t               navigator.serviceWorker.controller.postMessage(\n\t\t\t\t\t               {\n\t\t\t\t\t\t               \"data\":\n\t\t\t\t\t\t               {\n\t\t\t\t\t\t\t               \"dev_comm\": true,\n\t\t\t\t\t\t\t               \"id\": sku\n\t\t\t\t\t\t               }\n\t\t\t\t\t               });\n\n\t\t\t\t               })\n\t\t\t}\n\t\t}\n        deleteProductFromCache()\n\t\t{\n\t\t\tthis.send_message_to_sw(this.id);\n\t\t}\n\t\ttoggleCache()\n\t\t{\n\t\t\t// event.preventDefault();\n\t\t\tconsole.log(\"Firing for product: \", this.sku);\n\t\t\tif (this.cached)\n\t\t\t{\n\t\t\t\tthis.deleteProductFromCache()\n\t\t\t\t// this.cached = false;\n\t\t\t} else\n\t\t\t{\n\t\t\t\tthis.fetchProduct(this.id)\n\t\t\t\t// this.cached = true;\n\t\t\t}\n\t\t\tconsole.log(`Product ${this.id}: Cache = ${this.cached}`);\n\t\t\t// this.cached = !this.cached;\n\t\t}\n\n\n\tcreated()\n\t{\n\t\treturn this.searchCache(this.sku)\n\t\t           .then(result =>\n\t\t                 {\n\t\t\t                 console.log(\"Search from cache: \", result);\n\t\t\t                 if (result != null)\n\t\t\t\t                 this.cached = result;\n\t\t                 })\n\t\t// this.$store.dispatch('posts/fetchPost', this.id);\n\t}\n\t}\n",{"version":3,"sources":["Product.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;AAeA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Product.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <div v-if=\"product\"\n         style=\"padding: 2rem 4rem;\">\n        <img :src=\"product.getMainMedia()\"\n             style=\"width: 200px; height: 260px;\">\n        <h3>{{ product.getName() }}</h3>\n        <span>${{ product.getPrice()}}</span><br>\n        <span v-if=\"product.hasTierPrice()\">${{ product.getTierPrice()}}</span>\n        <v-switch v-model=\"cached\"\n                  @click.native=\"toggleCache();\"\n                  :label=\"`Product cached: ${cached.toString()}`\"></v-switch>\n    </div>\n</template>\n\n<script lang=\"ts\">\n\timport {MagentoAPIService} from \"../services/MagentoAPIService\";\n\timport {Product}           from \"../objects/Product\";\n\timport { Component, Vue }  from \"vue-property-decorator\";\n\n\tconst magentoApiService = new MagentoAPIService();\n\n\t@Component({\n\t\t           props:\n\t\t           {\n\t\t\t           sku: String\n\t\t           }\n\t           })\n\texport default class Product extends Vue\n\t{\n        cached: Boolean = false;\n\n\n\n\t\t\tgetproduct()\n\t\t{\n\t\t\tlet product = this.$store.getters['products/product'](this.sku);\n\t\t\tif (product == null && this.sku != null)\n\t\t\tthis.fetchProduct(this.sku);\n\t\t\treturn product;\n\t\t}\n\n\n\t\tsearchCache(sku)\n\t\t{\n\t\t\treturn window.caches.open('products-cache')\n\t\t\t             .then(cache =>\n\t\t\t                   {\n\t\t\t\t                   console.log(\"Searching keys for id\", sku);\n\t\t\t\t                   // console.log(\"KEYS\", keys);\n\t\t\t\t                   return cache.keys()\n\t\t\t\t                               .then(urls =>\n\t\t\t\t                                     {\n\t\t\t\t\t                                     for (let i = 0; i < urls.length; ++ i)\n\t\t\t\t\t                                     {\n\t\t\t\t\t\t                                     if (urls[i].url ===\n\t\t\t\t\t\t                                     `${MagentoAPIService.PRODUCTS_API}/${sku}`)\n\t\t\t\t\t\t\t                                     return true;\n\t\t\t\t\t                                     }\n\t\t\t\t\t                                     return false;\n\t\t\t\t                                     });\n\t\t\t                   }\n\t\t\t             )\n\t\t\t             .catch(error => {console.error(\"Error cached\", error)})\n\t\t}\n\t\tfetchProduct(sku)\n\t\t{\n\t\t\tthis.send_message_to_sw(this.sku);\n\t\t\tthis.$store.dispatch('products/fetchProduct', sku)\n\t\t\t    .then((data) =>\n\t\t\t          {\n\t\t\t\t          console.log('Fetch ok', data);\n\t\t\t          })\n\t\t\t    .catch((error) =>\n\t\t\t           {\n\t\t\t\t           console.error('Fetch error', error);\n\t\t\t           });\n\t\t}\n\t\tsend_message_to_sw(sku)\n\t\t{\n\t\t\tif ('serviceWorker' in navigator)\n\t\t\t{\n\t\t\t\tnavigator.serviceWorker.ready\n\t\t\t\t         .then(function (serviceWorkerRegistration)\n\t\t\t\t               {\n\t\t\t\t\t               // Let's see if you have a subscription already\n\t\t\t\t\t               return serviceWorkerRegistration.pushManager.getSubscription();\n\t\t\t\t               })\n\t\t\t\t         .then(function (subscription)\n\t\t\t\t               {\n\t\t\t\t\t               if (!subscription)\n\t\t\t\t\t               {\n\t\t\t\t\t\t               // You do not have subscription\n\t\t\t\t\t               }\n\t\t\t\t\t               // You have subscription.\n\t\t\t\t\t               // Send data to service worker\n\t\t\t\t\t               console.log(\"Sending to SW...\");\n\t\t\t\t\t               navigator.serviceWorker.controller.postMessage(\n\t\t\t\t\t               {\n\t\t\t\t\t\t               \"data\":\n\t\t\t\t\t\t               {\n\t\t\t\t\t\t\t               \"dev_comm\": true,\n\t\t\t\t\t\t\t               \"id\": sku\n\t\t\t\t\t\t               }\n\t\t\t\t\t               });\n\n\t\t\t\t               })\n\t\t\t}\n\t\t}\n        deleteProductFromCache()\n\t\t{\n\t\t\tthis.send_message_to_sw(this.id);\n\t\t}\n\t\ttoggleCache()\n\t\t{\n\t\t\t// event.preventDefault();\n\t\t\tconsole.log(\"Firing for product: \", this.sku);\n\t\t\tif (this.cached)\n\t\t\t{\n\t\t\t\tthis.deleteProductFromCache()\n\t\t\t\t// this.cached = false;\n\t\t\t} else\n\t\t\t{\n\t\t\t\tthis.fetchProduct(this.id)\n\t\t\t\t// this.cached = true;\n\t\t\t}\n\t\t\tconsole.log(`Product ${this.id}: Cache = ${this.cached}`);\n\t\t\t// this.cached = !this.cached;\n\t\t}\n\n\n\tcreated()\n\t{\n\t\treturn this.searchCache(this.sku)\n\t\t           .then(result =>\n\t\t                 {\n\t\t\t                 console.log(\"Search from cache: \", result);\n\t\t\t                 if (result != null)\n\t\t\t\t                 this.cached = result;\n\t\t                 })\n\t\t// this.$store.dispatch('posts/fetchPost', this.id);\n\t}\n\t}\n</script>\n\n<style scoped>\n\n</style>\n"]}]}