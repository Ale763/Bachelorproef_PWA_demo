{"remainingRequest":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/thread-loader/dist/cjs.js!/Users/ale/Documents/Bachproef/pwa-3/node_modules/babel-loader/lib/index.js!/Users/ale/Documents/Bachproef/pwa-3/node_modules/vuetify-loader/lib/loader.js!/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/ale/Documents/Bachproef/pwa-3/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/ale/Documents/Bachproef/pwa-3/src/components/Product.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/ale/Documents/Bachproef/pwa-3/src/components/Product.vue","mtime":1556569867880},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/vuetify-loader/lib/loader.js","mtime":1549812933000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/ale/Documents/Bachproef/pwa-3/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.to-string\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { MagentoAPIService } from \"../services/MagentoAPIService\";\nimport { Product } from \"../objects/Product\";\nvar magentoApiService = new MagentoAPIService();\nexport default {\n  name: \"product\",\n  props: {\n    sku: String\n  },\n  data: function data() {\n    return {\n      cached: false\n    };\n  },\n  computed: {\n    product: function product() {\n      var product = this.$store.getters['products/product'](this.sku);\n      if (product == null && this.sku != null) this.fetchProduct(this.sku);\n      return product;\n    }\n  },\n  methods: {\n    searchCache: function searchCache(sku) {\n      return window.caches.open('products-cache').then(function (cache) {\n        console.log(\"Searching keys for id\", sku); // console.log(\"KEYS\", keys);\n\n        return cache.keys().then(function (urls) {\n          for (var i = 0; i < urls.length; ++i) {\n            if (urls[i].url === \"\".concat(MagentoAPIService.PRODUCTS_API, \"/\").concat(sku)) return true;\n          }\n\n          return false;\n        });\n      }).catch(function (error) {\n        console.error(\"Error cached\", error);\n      });\n    },\n    fetchProduct: function fetchProduct(sku) {\n      this.send_message_to_sw(this.sku);\n      this.$store.dispatch('products/fetchProduct', sku).then(function (data) {\n        console.log('Fetch ok', data);\n      }).catch(function (error) {\n        console.error('Fetch error', error);\n      });\n    },\n    send_message_to_sw: function send_message_to_sw(sku) {\n      if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.ready.then(function (serviceWorkerRegistration) {\n          // Let's see if you have a subscription already\n          return serviceWorkerRegistration.pushManager.getSubscription();\n        }).then(function (subscription) {\n          if (!subscription) {} // You do not have subscription\n          // You have subscription.\n          // Send data to service worker\n\n\n          console.log(\"Sending to SW...\");\n          navigator.serviceWorker.controller.postMessage({\n            \"data\": {\n              \"dev_comm\": true,\n              \"id\": sku\n            }\n          });\n        });\n      }\n    },\n    deleteProductFromCache: function deleteProductFromCache() {\n      this.send_message_to_sw(this.id);\n    },\n    toggleCache: function toggleCache() {\n      // event.preventDefault();\n      console.log(\"Firing for product: \", this.sku);\n\n      if (this.cached) {\n        this.deleteProductFromCache(); // this.cached = false;\n      } else {\n        this.fetchProduct(this.id); // this.cached = true;\n      }\n\n      console.log(\"Product \".concat(this.id, \": Cache = \").concat(this.cached)); // this.cached = !this.cached;\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    return this.searchCache(this.sku).then(function (result) {\n      console.log(\"Search from cache: \", result);\n      if (result != null) _this.cached = result;\n    }); // this.$store.dispatch('posts/fetchPost', this.id);\n  }\n};",{"version":3,"sources":["Product.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div v-if=\"product\"\n         style=\"padding: 2rem 4rem;\">\n        <img :src=\"product.getMainMedia()\" style=\"width: 200px; height: 260px;\">\n        <h3>{{ product.getName() }}</h3>\n        <span>${{ product.getPrice()}}</span><br>\n<!--        <span v-if=\"product.hasTierPrice()\">${{ product.getTierPrice()}}</span>-->\n<!--        <v-switch v-model=\"cached\"-->\n<!--                  @click.native=\"toggleCache();\"-->\n<!--                  :label=\"`Product cached: ${cached.toString()}`\"></v-switch>-->\n    </div>\n</template>\n\n<script>\n\timport {MagentoAPIService} from \"../services/MagentoAPIService\";\n\timport {Product} from \"../objects/Product\";\n\n\tconst magentoApiService = new MagentoAPIService();\n\n\texport default {\n\t\tname: \"product\",\n\t\tprops:\n\t\t{\n\t\t\tsku: String\n\t\t},\n\t\tdata: function ()\n\t\t{\n            return {\n\t            cached: false\n            }\n\t\t},\n\t\tcomputed:\n\t\t{\n\t\t\tproduct()\n\t\t\t{\n\t\t\t\tlet product = this.$store.getters['products/product'](this.sku);\n\t\t\t\tif (product == null && this.sku != null)\n\t\t\t\t\tthis.fetchProduct(this.sku);\n\t\t\t\treturn product;\n\t\t\t}\n\t\t},\n\t\tmethods:\n\t\t{\n\t\t\tsearchCache(sku)\n\t\t\t{\n\t\t\t\treturn window.caches.open('products-cache')\n\t\t\t\t             .then(cache =>\n\t\t\t\t                   {\n\t\t\t\t\t                   console.log(\"Searching keys for id\", sku);\n\t\t\t\t\t                   // console.log(\"KEYS\", keys);\n\t\t\t\t\t                   return cache.keys()\n\t\t\t\t\t                               .then(urls =>\n\t\t\t\t\t                                     {\n\t\t\t\t\t\t                                     for (let i = 0; i < urls.length; ++ i)\n\t\t\t\t\t\t                                     {\n\t\t\t\t\t\t\t                                     if (urls[i].url ===\n\t\t\t\t\t\t\t                                     `${MagentoAPIService.PRODUCTS_API}/${sku}`)\n\t\t\t\t\t\t\t\t                                     return true;\n\t\t\t\t\t\t                                     }\n\t\t\t\t\t\t                                     return false;\n\t\t\t\t\t                                     });\n\t\t\t\t                   }\n\t\t\t\t             )\n\t\t\t\t             .catch(error => {console.error(\"Error cached\", error)})\n\t\t\t},\n\t\t\tfetchProduct(sku)\n\t\t\t{\n\t\t\t\tthis.send_message_to_sw(this.sku);\n\t\t\t\tthis.$store.dispatch('products/fetchProduct', sku)\n\t\t\t\t    .then((data) =>\n\t\t\t\t          {\n\t\t\t\t\t          console.log('Fetch ok', data);\n\t\t\t\t          })\n\t\t\t\t    .catch((error) =>\n\t\t\t\t           {\n\t\t\t\t\t           console.error('Fetch error', error);\n\t\t\t\t           });\n\t\t\t},\n\t\t\tsend_message_to_sw(sku)\n\t\t\t{\n\t\t\t\tif ('serviceWorker' in navigator)\n\t\t\t\t{\n\t\t\t\t\tnavigator.serviceWorker.ready\n\t\t\t\t\t         .then(function (serviceWorkerRegistration)\n\t\t\t\t\t               {\n\t\t\t\t\t\t               // Let's see if you have a subscription already\n\t\t\t\t\t\t               return serviceWorkerRegistration.pushManager.getSubscription();\n\t\t\t\t\t               })\n\t\t\t\t\t         .then(function (subscription)\n\t\t\t\t\t               {\n\t\t\t\t\t\t               if (!subscription)\n\t\t\t\t\t\t               {\n\t\t\t\t\t\t\t               // You do not have subscription\n\t\t\t\t\t\t               }\n\t\t\t\t\t\t               // You have subscription.\n\t\t\t\t\t\t               // Send data to service worker\n\t\t\t\t\t\t               console.log(\"Sending to SW...\");\n\t\t\t\t\t\t               navigator.serviceWorker.controller.postMessage(\n\t\t\t\t\t\t               {\n\t\t\t\t\t\t\t               \"data\":\n\t\t\t\t\t\t\t               {\n\t\t\t\t\t\t\t\t               \"dev_comm\": true,\n\t\t\t\t\t\t\t\t               \"id\": sku\n\t\t\t\t\t\t\t               }\n\t\t\t\t\t\t               });\n\n\t\t\t\t\t               })\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeleteProductFromCache()\n\t\t\t{\n\t\t\t\tthis.send_message_to_sw(this.id);\n\t\t\t},\n\t\t\ttoggleCache()\n\t\t\t{\n\t\t\t\t// event.preventDefault();\n\t\t\t\tconsole.log(\"Firing for product: \", this.sku);\n\t\t\t\tif (this.cached)\n\t\t\t\t{\n\t\t\t\t\tthis.deleteProductFromCache()\n\t\t\t\t\t// this.cached = false;\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\tthis.fetchProduct(this.id)\n\t\t\t\t\t// this.cached = true;\n\t\t\t\t}\n\t\t\t\tconsole.log(`Product ${this.id}: Cache = ${this.cached}`);\n\t\t\t\t// this.cached = !this.cached;\n\t\t\t}\n\n\t\t},\n\t\tcreated()\n\t\t{\n\t\t\treturn this.searchCache(this.sku)\n\t\t\t           .then(result =>\n\t\t\t                 {\n\t\t\t\t                 console.log(\"Search from cache: \", result);\n\t\t\t\t                 if (result != null)\n\t\t\t\t\t                 this.cached = result;\n\t\t\t                 })\n\t\t\t// this.$store.dispatch('posts/fetchPost', this.id);\n\t\t}\n\t}\n</script>\n\n<style scoped>\n\n</style>\n"],"sourceRoot":"src/components"}]}