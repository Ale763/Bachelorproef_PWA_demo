(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["update"],{"0094":function(t,e,i){},"2db4":function(t,e,i){"use strict";i("0094");var n=i("b64a"),a=i("98a1"),s=i("c22b"),r=i("58df");e["a"]=Object(r["a"])(n["a"],a["a"],Object(s["b"])(["absolute","top","bottom","left","right"])).extend({name:"v-snackbar",props:{autoHeight:Boolean,multiLine:Boolean,timeout:{type:Number,default:6e3},vertical:Boolean},data:function(){return{activeTimeout:-1}},computed:{classes:function(){return{"v-snack--active":this.isActive,"v-snack--absolute":this.absolute,"v-snack--auto-height":this.autoHeight,"v-snack--bottom":this.bottom||!this.top,"v-snack--left":this.left,"v-snack--multi-line":this.multiLine&&!this.vertical,"v-snack--right":this.right,"v-snack--top":this.top,"v-snack--vertical":this.vertical}}},watch:{isActive:function(){this.setTimeout()}},mounted:function(){this.setTimeout()},methods:{setTimeout:function(){var t=this;window.clearTimeout(this.activeTimeout),this.isActive&&this.timeout&&(this.activeTimeout=window.setTimeout(function(){t.isActive=!1},this.timeout))}},render:function(t){return t("transition",{attrs:{name:"v-snack-transition"}},this.isActive&&[t("div",{staticClass:"v-snack",class:this.classes,on:this.$listeners},[t("div",this.setBackgroundColor(this.color,{staticClass:"v-snack__wrapper"}),[t("div",{staticClass:"v-snack__content"},this.$slots.default)])])])}})},"2e8c":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{margin:"0 auto",padding:"1rem"}},[i("h2",{staticStyle:{"text-align":"right"}},[t.update?i("div",{staticStyle:{color:"dodgerblue"}},[i("v-icon",{staticStyle:{color:"dodgerblue","padding-right":"1rem"}},[t._v("update")]),t._v("\n            Update available\n        ")],1):t._e(),t.update?t._e():i("div",{},[i("v-icon",{staticStyle:{"padding-right":"1rem"}},[t._v("update")]),t._v("No update available\n        ")],1)]),t._m(0),i("div",{staticStyle:{width:"100%","text-align":"center"}},[i("v-btn",{attrs:{round:"",dark:"",color:"teal"},on:{click:function(e){return t.toggleSW()}}},[t._v("Update SW")]),i("v-btn",{attrs:{round:"",dark:"",color:"teal"},on:{click:function(e){return t.unregister_sw()}}},[t._v("Unregister SW")])],1),i("v-snackbar",{attrs:{timeout:0,vertical:!0},model:{value:t.multiClientUpdate,callback:function(e){t.multiClientUpdate=e},expression:"multiClientUpdate"}},[t._v("\n        A new update is available.\n        All pages will be reloaded after the update is complete.\n        Please update.\n        "),i("v-btn",{attrs:{dark:"",flat:""},on:{click:t.update_sw}},[t._v("\n            Update\n        ")]),i("v-btn",{attrs:{dark:"",flat:""},on:{click:function(e){t.multiClientUpdate=!1}}},[t._v("\n            Close\n        ")])],1)],1)},a=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"block","text-align":"center"}},[i("img",{staticStyle:{display:"block",height:"250px","max-width":"100%",margin:"0 auto"},attrs:{src:"/img/horse.png"}}),i("div",{staticStyle:{display:"block",height:"250px","max-width":"100%"},attrs:{id:"imgElement"}})])}],s=i("f499"),r=i.n(s),o=(i("96cf"),i("3b8d")),c=(i("28ba"),i("a002")),l={name:"Update",data:function(){return{service_worker:null,newWorker:null,pageTitle:"Update",swName:"sw.js",lf:null,firebaseToken:null,update:!1,multiclient:!1,multiClientUpdate:!1,refreshing:!1}},computed:{},created:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log("Creating Update, ",window.location.pathname),t.next=3,c["createInstance"]({name:"lf"});case 3:return this.lf=t.sent,t.next=6,this.lf.getItem("VersionSW");case 6:e=t.sent,null==e&&this.lf.setItem("VersionSW",0),this.install_sw(),setTimeout(function(){var t=document.createElement("img");t.src="/img/horse.png",t.style="max-width: 100%; height: 250px;",document.getElementById("imgElement")&&document.getElementById("imgElement").appendChild(t)},4500);case 10:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),methods:{install_sw:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e,i,n=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=window.location.pathname,"/"!==e){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,this.lf.getItem("VersionSW");case 5:i=t.sent,null==i&&(i=0),"/update-without-skip-and-claim"===e?(this.pageTitle="Default update",this.swName=0===i?"/sw-without-skip-and-claim.js":"/sw-without-skip-and-claim-2.js"):"/update-with-skip-no-claim"===e?(this.pageTitle="Forced update",this.swName=0===i?"/sw-with-skip-no-claim.js":"/sw-with-skip-no-claim-2.js"):"/update-with-skip-and-claim"===e?(this.pageTitle="Forced update & immediate control",this.swName=0===i?"/sw-with-skip-and-claim.js":"/sw-with-skip-and-claim-2.js"):"/single-client-update"===e?(this.pageTitle="Single Client Update",this.swName=0===i?"/sw-single-client-update.js":"/sw-single-client-update-2.js"):"/multi-client-update"===e&&(this.pageTitle="Multi Client Update",this.multiclient=!0,this.swName=0===i?"/sw-multi-client-update.js":"/sw-multi-client-update-2.js"),navigator.serviceWorker.register(this.swName,{scope:e}).then(function(t){if(n.registration=t,n._updateListener(),n.multiclient){var e=n;navigator.serviceWorker.addEventListener("controllerchange",function(){e.refreshing||(e.refreshing=!0,window.location.reload())})}},function(t){console.log("SW UPDATE_DEMO FAILED: ",t)});case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),_updateListener:function(){var t=this;this.registration.waiting&&this.registration.active?(this._setUpdateStatus(!0),this.newWorker=this.registration.waiting):this.registration.addEventListener("updatefound",function(){t.newWorker=t.registration.installing,t.registration.addEventListener("controllerchange",function(){t._setUpdateStatus(!1)}),t.newWorker.addEventListener("statechange",function(){switch(t.newWorker.state){case"installed":console.log("SW DETECTING UPDATE 2"),t._setUpdateStatus(!0);break;case"activated":navigator.serviceWorker.controller&&(console.log("SW ACTIVATED"),t._setUpdateStatus(!1)),t.lf.getItem("updating");break}})})},unregister_sw:function(){this.registration.unregister().then(function(){console.log("Unregister")})},toggleSW:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.lf.setItem("UAV",!0),t.next=3,this.lf.getItem("VersionSW");case 3:e=t.sent,1===e||null==e?this.lf.setItem("VersionSW",0):this.lf.setItem("VersionSW",1),this.registration.update();case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),request_from_sw:function(){var t=this,e=window.location.pathname;this.registration.update();var i=new Request("/".concat(this.swName)),n={method:"GET"};return fetch(i,n).then(function(i){return navigator.serviceWorker.register(t.swName,{scope:e}).then(function(e){t.registration=e},function(t){console.log("SW UPDATE_DEMO FAILED: ",t)}).then(function(){return t.service_worker=navigator.serviceWorker,navigator.serviceWorker.ready}),i}).catch(function(t){return console.error(t),console.error(r()(t)),{request:i,response:response}})},send_new_sw:function(){this.$emit("updateRequest")},update_sw:function(){this.newWorker.postMessage({action:"skipWaiting"})},getSWClients:function(){if(navigator.serviceWorker.controller){var t=new MessageChannel;t.port1.onmessage=function(t){console.log("Response from the SW : ",t.data.message)},console.log("Sending message to the service worker"),navigator.serviceWorker.controller.postMessage({command:"twoWayCommunication",message:"Hi, SW"},[t.port2])}else console.log("No active ServiceWorker")},_navigateTo:function(t){window.location=t},_setUpdateStatus:function(t){this.registration.active&&(this.update=t,this.multiclient&&(this.multiClientUpdate=t))}}},u=l,d=i("2877"),h=i("6544"),p=i.n(h),m=i("8336"),g=i("132d"),v=i("2db4"),w=Object(d["a"])(u,n,a,!1,null,"59e3858a",null);e["default"]=w.exports;p()(w,{VBtn:m["a"],VIcon:g["a"],VSnackbar:v["a"]})}}]);
//# sourceMappingURL=update.bed563ac.js.map